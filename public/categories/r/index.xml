<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>R | D. Kyle Ward</title>
    <link>/categories/r/</link>
      <atom:link href="/categories/r/index.xml" rel="self" type="application/rss+xml" />
    <description>R</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><lastBuildDate>Tue, 03 Sep 2019 00:00:00 +0000</lastBuildDate>
    <image>
      <url>/img/icon-192.png</url>
      <title>R</title>
      <link>/categories/r/</link>
    </image>
    
    <item>
      <title>Understanding Transit Ridership Trends</title>
      <link>/post/2019-09-03-transit/2019-09-03-transit/</link>
      <pubDate>Tue, 03 Sep 2019 00:00:00 +0000</pubDate>
      <guid>/post/2019-09-03-transit/2019-09-03-transit/</guid>
      <description>
&lt;script src=&#34;/rmarkdown-libs/htmlwidgets/htmlwidgets.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/plotly-binding/plotly.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/typedarray/typedarray.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/jquery/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;/rmarkdown-libs/crosstalk/css/crosstalk.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;/rmarkdown-libs/crosstalk/js/crosstalk.min.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;/rmarkdown-libs/plotly-main/plotly-latest.min.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;Before talking about national transit trends, it’s important to grasp the size
of the NYC market. The chart below shows the top 10 transit agencies by monthly
ridership (unlinked passenger trips). NYC dwarfs the other transit markets, and
for this post, is set aside as an outlier.&lt;/p&gt;
&lt;div id=&#34;htmlwidget-1&#34; style=&#34;width:100%;height:480px;&#34; class=&#34;plotly html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-1&#34;&gt;{&#34;x&#34;:{&#34;visdat&#34;:{&#34;936c1c76604&#34;:[&#34;function () &#34;,&#34;plotlyVisDat&#34;]},&#34;cur_data&#34;:&#34;936c1c76604&#34;,&#34;attrs&#34;:{&#34;936c1c76604&#34;:{&#34;y&#34;:{},&#34;x&#34;:{},&#34;orientation&#34;:&#34;h&#34;,&#34;text&#34;:[&#34;Alameda-Contra Costa Transit District&#34;,&#34;Northeast Illinois Regional Commuter&#34;,&#34;Metro Transit&#34;,&#34;San Diego Metropolitan Transit&#34;,&#34;Metro-North Commuter Railroad Company&#34;,&#34;Port Authority Trans-Hudson Corporation&#34;,&#34;MTA Long Island Rail&#34;,&#34;MTA Bus Company&#34;,&#34;Los Angeles County Metropolitan&#34;,&#34;MTA New York City&#34;],&#34;textposition&#34;:&#34;auto&#34;,&#34;hoverinfo&#34;:&#34;x&#34;,&#34;alpha_stroke&#34;:1,&#34;sizes&#34;:[10,100],&#34;spans&#34;:[1,20],&#34;type&#34;:&#34;bar&#34;}},&#34;layout&#34;:{&#34;margin&#34;:{&#34;b&#34;:40,&#34;l&#34;:60,&#34;t&#34;:25,&#34;r&#34;:10},&#34;yaxis&#34;:{&#34;domain&#34;:[0,1],&#34;automargin&#34;:true,&#34;categoryorder&#34;:&#34;array&#34;,&#34;categoryarray&#34;:[&#34;Alameda-Contra Costa Transit District&#34;,&#34;Northeast Illinois Regional Commuter&#34;,&#34;Metro Transit&#34;,&#34;San Diego Metropolitan Transit&#34;,&#34;Metro-North Commuter Railroad Company&#34;,&#34;Port Authority Trans-Hudson Corporation&#34;,&#34;MTA Long Island Rail&#34;,&#34;MTA Bus Company&#34;,&#34;Los Angeles County Metropolitan&#34;,&#34;MTA New York City&#34;],&#34;showticklabels&#34;:false,&#34;title&#34;:&#34;Agency&#34;,&#34;type&#34;:&#34;category&#34;},&#34;xaxis&#34;:{&#34;domain&#34;:[0,1],&#34;automargin&#34;:true,&#34;title&#34;:&#34;Trips&#34;},&#34;hovermode&#34;:&#34;closest&#34;,&#34;showlegend&#34;:false},&#34;source&#34;:&#34;A&#34;,&#34;config&#34;:{&#34;showSendToCloud&#34;:false},&#34;data&#34;:[{&#34;y&#34;:[&#34;Alameda-Contra Costa Transit District&#34;,&#34;Northeast Illinois Regional Commuter&#34;,&#34;Metro Transit&#34;,&#34;San Diego Metropolitan Transit&#34;,&#34;Metro-North Commuter Railroad Company&#34;,&#34;Port Authority Trans-Hudson Corporation&#34;,&#34;MTA Long Island Rail&#34;,&#34;MTA Bus Company&#34;,&#34;Los Angeles County Metropolitan&#34;,&#34;MTA New York City&#34;],&#34;x&#34;:[4200991,5799729,6296585,6768870,7301558,7441937,9405105,10743094,29695526,286679255],&#34;orientation&#34;:&#34;h&#34;,&#34;text&#34;:[&#34;Alameda-Contra Costa Transit District&#34;,&#34;Northeast Illinois Regional Commuter&#34;,&#34;Metro Transit&#34;,&#34;San Diego Metropolitan Transit&#34;,&#34;Metro-North Commuter Railroad Company&#34;,&#34;Port Authority Trans-Hudson Corporation&#34;,&#34;MTA Long Island Rail&#34;,&#34;MTA Bus Company&#34;,&#34;Los Angeles County Metropolitan&#34;,&#34;MTA New York City&#34;],&#34;textposition&#34;:[&#34;auto&#34;,&#34;auto&#34;,&#34;auto&#34;,&#34;auto&#34;,&#34;auto&#34;,&#34;auto&#34;,&#34;auto&#34;,&#34;auto&#34;,&#34;auto&#34;,&#34;auto&#34;],&#34;hoverinfo&#34;:[&#34;x&#34;,&#34;x&#34;,&#34;x&#34;,&#34;x&#34;,&#34;x&#34;,&#34;x&#34;,&#34;x&#34;,&#34;x&#34;,&#34;x&#34;,&#34;x&#34;],&#34;type&#34;:&#34;bar&#34;,&#34;marker&#34;:{&#34;color&#34;:&#34;rgba(31,119,180,1)&#34;,&#34;line&#34;:{&#34;color&#34;:&#34;rgba(31,119,180,1)&#34;}},&#34;error_y&#34;:{&#34;color&#34;:&#34;rgba(31,119,180,1)&#34;},&#34;error_x&#34;:{&#34;color&#34;:&#34;rgba(31,119,180,1)&#34;},&#34;xaxis&#34;:&#34;x&#34;,&#34;yaxis&#34;:&#34;y&#34;,&#34;frame&#34;:null}],&#34;highlight&#34;:{&#34;on&#34;:&#34;plotly_click&#34;,&#34;persistent&#34;:false,&#34;dynamic&#34;:false,&#34;selectize&#34;:false,&#34;opacityDim&#34;:0.2,&#34;selected&#34;:{&#34;opacity&#34;:1},&#34;debounce&#34;:0},&#34;shinyEvents&#34;:[&#34;plotly_hover&#34;,&#34;plotly_click&#34;,&#34;plotly_selected&#34;,&#34;plotly_relayout&#34;,&#34;plotly_brushed&#34;,&#34;plotly_brushing&#34;,&#34;plotly_clickannotation&#34;,&#34;plotly_doubleclick&#34;,&#34;plotly_deselect&#34;,&#34;plotly_afterplot&#34;],&#34;base_url&#34;:&#34;https://plot.ly&#34;},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;p&gt;Outside of NYC, how has transit been performing in the age of Uber and Lyft?&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Introducing the ipfr package</title>
      <link>/post/2019-08-27-ipfr/2019-08-27-ipfr/</link>
      <pubDate>Wed, 28 Aug 2019 00:00:00 +0000</pubDate>
      <guid>/post/2019-08-27-ipfr/2019-08-27-ipfr/</guid>
      <description>


&lt;p&gt;I’m happy to announce that the &lt;a href=&#34;https://github.com/dkyleward/ipfr&#34;&gt;ipfr package&lt;/a&gt;
is available on CRAN! The goal of this package is to make survey expansion,
matrix balancing, and population synthesis easier.&lt;/p&gt;
&lt;p&gt;A basic use case is the task of balancing a matrix to row and column targets:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ipfr)
library(dplyr)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mtx &amp;lt;- matrix(data = runif(9), nrow = 3, ncol = 3)
row_targets &amp;lt;- c(3, 4, 5)
column_targets &amp;lt;- c(5, 4, 3)
result &amp;lt;- ipu_matrix(mtx, row_targets, column_targets)

rowSums(result)
#&amp;gt; [1] 3.000001 4.000015 4.999985
colSums(result)
#&amp;gt; [1] 5 4 3&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The example below creates a simple survey and expands it to meet known
population targets. Each row in the &lt;code&gt;survey&lt;/code&gt; data frame represents a household
and contains information on the number of household members (&lt;code&gt;size&lt;/code&gt;) and number
of &lt;code&gt;autos&lt;/code&gt;. The &lt;code&gt;targets&lt;/code&gt; list contains population targets that the survey
expansion should match. For example, there should be a total of 75 households
with 1 person.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;survey &amp;lt;- tibble(
  size = c(1, 2, 1, 1),
  autos = c(0, 2, 2, 1),
  weight = 1
)
targets &amp;lt;- list()
targets$size &amp;lt;- tibble(
  `1` = 75,
  `2` = 25
)
targets$autos &amp;lt;- tibble(
  `0` = 25,
  `1` = 50,
  `2` = 25
)
result &amp;lt;- ipu(survey, targets)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The package also supports a number of advanced features:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Match to household- and person-level targets simultaneously&lt;/li&gt;
&lt;li&gt;View and restrict the distribution of resulting weights&lt;/li&gt;
&lt;li&gt;Control by geography&lt;/li&gt;
&lt;li&gt;Handle target agreement and importance&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Finally, the resulting weight table can be used to easily create a synthetic
population:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;synthesize(result$weight_tbl)
#&amp;gt; # A tibble: 100 x 4
#&amp;gt;    new_id    id  size autos
#&amp;gt;     &amp;lt;int&amp;gt; &amp;lt;int&amp;gt; &amp;lt;dbl&amp;gt; &amp;lt;dbl&amp;gt;
#&amp;gt;  1      1     1     1     0
#&amp;gt;  2      2     4     1     1
#&amp;gt;  3      3     1     1     0
#&amp;gt;  4      4     2     2     2
#&amp;gt;  5      5     4     1     1
#&amp;gt;  6      6     4     1     1
#&amp;gt;  7      7     2     2     2
#&amp;gt;  8      8     2     2     2
#&amp;gt;  9      9     4     1     1
#&amp;gt; 10     10     4     1     1
#&amp;gt; # ... with 90 more rows&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
  </channel>
</rss>
